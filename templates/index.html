<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Treino Dioguinho</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
<meta name="theme-color" content="#050505">

<link rel="apple-touch-icon" href="/static/icons/icon-512.png">

<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#1bd5ff">


</head>
<body>

<header>
    <h1>Ficha de Treino Diogo</h1>
    <p>bom treino!!!</p>

    <button id="toggle-theme" class="theme-btn" aria-label="Alternar tema">
        <span id="theme-icon">ðŸŒ™</span>
    </button>
</header>

<nav class="mobile-menu">
    <button data-treino="A">Treino A</button>
    <button data-treino="B">Treino B</button>
    <button data-treino="C">Treino C</button>
    <button data-treino="D">Treino D</button>
    <button data-treino="E">Treino E</button>
</nav>


<main class="container">

    {% for nome_treino, exercicios in treinos.items() %}

    <section class="card treino" data-treino="{{ nome_treino[0] }}">
    <h2>{{ nome_treino }}</h2>

        <ul class="exercise-list">
            {% for exercicio, link in exercicios %}

          <li class="exercise" data-exercicio="{{ nome_treino }}-{{ exercicio }}">

    <div class="exercise-header">
        <span class="exercise-name">{{ exercicio }}</span>

        <a href="{{ link }}" target="_blank" class="video-btn">
            â–¶ VÃ­deo
        </a>
    </div>

    <!-- SÃ‰RIES FIXAS (4 SÃ‰RIES) -->
    <div class="series-container"></div>

</li>


    <!-- SÃ‰RIES GERADAS AUTOMATICAMENTE -->
    <div class="series-container"></div>

</li>

            {% endfor %}
        </ul>
    </section>
    {% endfor %}

</main>

<footer>
    <p>Projeto treino â€¢ Marizinha</p>
</footer>


<script>
/* ===== TEMA ===== */
const btn = document.getElementById("toggle-theme");
const icon = document.getElementById("theme-icon");

if (localStorage.getItem("theme") === "light") {
    document.body.classList.add("light");
    icon.textContent = "â˜€ï¸";
}

btn.addEventListener("click", () => {
    document.body.classList.toggle("light");
    localStorage.setItem(
        "theme",
        document.body.classList.contains("light") ? "light" : "dark"
    );
    icon.textContent = document.body.classList.contains("light") ? "â˜€ï¸" : "ðŸŒ™";
});

document.querySelectorAll(".exercise").forEach(exercise => {

    const container = exercise.querySelector(".series-container");
    const baseKey = exercise.dataset.exercicio;

    criarSeriesFixas();

    function criarSeriesFixas() {
        container.innerHTML = "";

        for (let i = 1; i <= 4; i++) {
            const row = document.createElement("div");
            row.className = "series-row";

            const label = document.createElement("span");
            label.textContent = "SÃ©rie " + i;

            const reps = document.createElement("input");
            reps.type = "number";
            reps.placeholder = "Reps";

            const carga = document.createElement("input");
            carga.type = "number";
            carga.placeholder = "Kg";

            const repsKey = `${baseKey}-s${i}-reps`;
            const cargaKey = `${baseKey}-s${i}-kg`;

            if (localStorage.getItem(repsKey)) reps.value = localStorage.getItem(repsKey);
            if (localStorage.getItem(cargaKey)) carga.value = localStorage.getItem(cargaKey);

            reps.addEventListener("input", () => {
                localStorage.setItem(repsKey, reps.value);
            });

            carga.addEventListener("input", () => {
                localStorage.setItem(cargaKey, carga.value);
            });

            row.append(label, reps, carga);
            container.appendChild(row);
        }
    }
});

/* ===== MENU MOBILE TREINOS ===== */
const menuButtons = document.querySelectorAll(".mobile-menu button");
const treinos = document.querySelectorAll(".treino");

// DEFINE TREINO PADRÃƒO
let treinoAtivo = localStorage.getItem("treinoAtivo") || "A";

function ativarTreino(letra) {
    treinos.forEach(t => {
        t.classList.toggle("active", t.dataset.treino === letra);
    });

    menuButtons.forEach(b => {
        b.classList.toggle("active", b.dataset.treino === letra);
    });

    localStorage.setItem("treinoAtivo", letra);
}

// EVENTOS
menuButtons.forEach(btn => {
    btn.addEventListener("click", () => {
        ativarTreino(btn.dataset.treino);
    });
});

// INICIALIZA
ativarTreino(treinoAtivo);

if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/static/service-worker.js")
        .then(() => console.log("Service Worker registrado"))
        .catch(err => console.log("Erro SW", err));

}

</script>


</body>
</html>
